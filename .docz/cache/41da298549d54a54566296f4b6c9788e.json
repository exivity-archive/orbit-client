{"remainingRequest":"c:\\code\\exivity\\orbit-client\\node_modules\\babel-loader\\lib\\index.js?{\"presets\":[[\"@babel/preset-env\",{\"useBuiltIns\":\"entry\",\"modules\":false}],\"@babel/preset-react\",[\"c:\\\\code\\\\exivity\\\\orbit-client\\\\node_modules\\\\docz\\\\node_modules\\\\babel-preset-docz\\\\dist\\\\index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-proposal-class-properties\",\"babel-plugin-styled-components\",[\"c:\\\\code\\\\exivity\\\\orbit-client\\\\node_modules\\\\docz-utils\\\\lib\\\\named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"c:\\\\code\\\\exivity\\\\orbit-client\\\\node_modules\\\\docz\\\\node_modules\\\\react-hot-loader\\\\babel.js\"],\"env\":{\"test\":{\"presets\":[\"@babel/preset-env\",\"@babel/preset-react\"]}},\"cacheDirectory\":true,\"babelrc\":false}!c:\\code\\exivity\\orbit-client\\src\\utils\\selectors.js","dependencies":[{"path":"c:\\code\\exivity\\orbit-client\\src\\utils\\selectors.js","mtime":1549007024782},{"path":"c:\\code\\exivity\\orbit-client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1543011188795},{"path":"c:\\code\\exivity\\orbit-client\\node_modules\\babel-loader\\lib\\index.js","mtime":1542804666583}],"contextDependencies":[],"result":["(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nimport { createSelector } from 'reselect';\nimport omit from 'lodash/omit';\nimport { notAllowedPropsCollection } from '../components/Collection';\nimport { notAllowedPropsRecord } from '../components/Record';\nimport { curried, insertIf } from '../components/helpers';\nexport var getIdsFromRelatedCollection = function getIdsFromRelatedCollection(relatedToCollection, ownType) {\n  return relatedToCollection.reduce(function (ids, record) {\n    var idsToAdd = record.relationships && record.relationships[ownType] && record.relationships[ownType].data.map(function (item) {\n      return item.id;\n    });\n    if (idsToAdd) return ids.concat(idsToAdd);\n    return ids;\n  }, []);\n};\nexport var findRelatedRecords = function findRelatedRecords(collection, relatedIds) {\n  return collection.filter(function (record) {\n    return relatedIds.includes(record.id);\n  });\n};\n\nvar relatedToSelector = function relatedToSelector(mergedProps) {\n  return mergedProps.ownProps.relatedTo;\n};\n\nvar collection = function collection(mergedProps) {\n  return mergedProps.record[mergedProps.pluralizedType];\n};\n\nexport var getRelatedRecords = createSelector(relatedToSelector, collection, function (relatedCollection, collection) {\n  var relatedIds = getIdsFromRelatedCollection(relatedCollection);\n  return findRelatedRecords(collection, relatedIds);\n});\nexport var memoizedCollectionAndHelpers = createSelector(function (_ref) {\n  var props = _ref.props;\n  return props;\n}, function (_ref2) {\n  var state = _ref2.state;\n  return state.loading;\n}, function (_ref3) {\n  var state = _ref3.state;\n  return state.error;\n}, function (_ref4) {\n  var collection = _ref4.collection;\n  return collection;\n}, function (_ref5) {\n  var buildSaveTransforms = _ref5.buildSaveTransforms;\n  return buildSaveTransforms;\n}, function (_ref6) {\n  var buildRemoveTransforms = _ref6.buildRemoveTransforms;\n  return buildRemoveTransforms;\n}, function (_ref7) {\n  var pluralizedType = _ref7.pluralizedType;\n  return pluralizedType;\n}, function (props, loading, error, collection, buildSaveTransforms, buildRemoveTransforms, pluralizedType) {\n  var _objectSpread2;\n\n  var receivedEntities = omit(props, _toConsumableArray(notAllowedPropsCollection).concat([props.type]));\n  var isLoading = !!props.loading || loading;\n  var hasError = props.error || error;\n  var cacheOnly = props.cache !== 'skip';\n  var queryStatus = isLoading || hasError ? null : collection;\n  return _objectSpread({}, receivedEntities, (_objectSpread2 = {}, _defineProperty(_objectSpread2, pluralizedType, cacheOnly ? collection : queryStatus), _defineProperty(_objectSpread2, \"save\", function save(collection) {\n    return props.updateStore(buildSaveTransforms(collection));\n  }), _defineProperty(_objectSpread2, \"remove\", function remove(collection) {\n    return props.updateStore(buildRemoveTransforms(collection));\n  }), _objectSpread2), insertIf(!cacheOnly, {\n    loading: isLoading\n  }), insertIf(!cacheOnly, {\n    error: hasError\n  }));\n});\nexport var memoizedGetExtendedRecord = createSelector(function (_ref8) {\n  var state = _ref8.state;\n  return state.record;\n}, function (_ref9) {\n  var props = _ref9.props;\n  return props.addRecord;\n}, function (_ref10) {\n  var props = _ref10.props;\n  return props.updateRecord;\n}, function (_ref11) {\n  var props = _ref11.props;\n  return props.removeRecord;\n}, function (_ref12) {\n  var setAttribute = _ref12.setAttribute;\n  return setAttribute;\n}, function (_ref13) {\n  var setRelationship = _ref13.setRelationship;\n  return setRelationship;\n}, function (_ref14) {\n  var addRelationship = _ref14.addRelationship;\n  return addRelationship;\n}, function (_ref15) {\n  var removeRelationship = _ref15.removeRelationship;\n  return removeRelationship;\n}, function (_ref16) {\n  var resetAttributes = _ref16.resetAttributes;\n  return resetAttributes;\n}, function (_ref17) {\n  var setProperty = _ref17.setProperty;\n  return setProperty;\n}, function (_ref18) {\n  var getRelatedIds = _ref18.getRelatedIds;\n  return getRelatedIds;\n}, function (_ref19) {\n  var getRelatedId = _ref19.getRelatedId;\n  return getRelatedId;\n}, function (record, addRecord, updateRecord, removeRecord, setAttribute, setRelationship, addRelationship, removeRelationship, resetAttributes, setProperty, getRelatedIds, getRelatedId) {\n  if (!record) return null;\n  return _objectSpread({}, record, {\n    setAttribute: curried(setAttribute),\n    setRelationship: curried(setRelationship),\n    addRelationship: addRelationship,\n    removeRelationship: removeRelationship,\n    resetAttributes: resetAttributes,\n    setProperty: setProperty,\n    getRelatedIds: getRelatedIds,\n    getRelatedId: getRelatedId,\n    save: record && !record.id ? function (options) {\n      return addRecord(_objectSpread({}, record), options);\n    } : function (options) {\n      return updateRecord(_objectSpread({}, record), options);\n    },\n    remove: function remove(options) {\n      return removeRecord(_objectSpread({}, record), options);\n    }\n  });\n});\nexport var memoizedGetRecordAndHelpers = createSelector(function (_ref20) {\n  var props = _ref20.props;\n  return props;\n}, function (_ref21) {\n  var state = _ref21.state;\n  return state.loading;\n}, function (_ref22) {\n  var state = _ref22.state;\n  return state.error;\n}, function (_ref23) {\n  var record = _ref23.record;\n  return record;\n}, function (props, loading, error, record) {\n  var receivedEntities = omit(props, _toConsumableArray(notAllowedPropsRecord).concat(['record', 'loading', 'error', 'initialRecord']));\n  return props.initialRecord ? _objectSpread(_defineProperty({}, props.type, record), receivedEntities) : _objectSpread(_defineProperty({}, props.type, record), receivedEntities, {\n    loading: loading,\n    error: error\n  });\n});\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(getIdsFromRelatedCollection, \"getIdsFromRelatedCollection\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(findRelatedRecords, \"findRelatedRecords\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(relatedToSelector, \"relatedToSelector\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(collection, \"collection\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(getRelatedRecords, \"getRelatedRecords\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(memoizedCollectionAndHelpers, \"memoizedCollectionAndHelpers\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(memoizedGetExtendedRecord, \"memoizedGetExtendedRecord\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  reactHotLoader.register(memoizedGetRecordAndHelpers, \"memoizedGetRecordAndHelpers\", \"c:\\\\code\\\\exivity\\\\orbit-client\\\\src\\\\utils\\\\selectors.js\");\n  leaveModule(module);\n})();\n\n;",{"version":3,"sources":["c:\\code\\exivity\\orbit-client\\src\\utils\\selectors.js"],"names":["createSelector","omit","notAllowedPropsCollection","notAllowedPropsRecord","curried","insertIf","getIdsFromRelatedCollection","relatedToCollection","ownType","reduce","ids","record","idsToAdd","relationships","data","map","item","id","concat","findRelatedRecords","collection","relatedIds","filter","includes","relatedToSelector","mergedProps","ownProps","relatedTo","pluralizedType","getRelatedRecords","relatedCollection","memoizedCollectionAndHelpers","props","state","loading","error","buildSaveTransforms","buildRemoveTransforms","receivedEntities","type","isLoading","hasError","cacheOnly","cache","queryStatus","updateStore","memoizedGetExtendedRecord","addRecord","updateRecord","removeRecord","setAttribute","setRelationship","addRelationship","removeRelationship","resetAttributes","setProperty","getRelatedIds","getRelatedId","save","options","remove","memoizedGetRecordAndHelpers","initialRecord"],"mappings":"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","sourcesContent":["import { createSelector } from 'reselect'\r\nimport omit from 'lodash/omit'\r\n\r\nimport { notAllowedPropsCollection } from '../components/Collection'\r\nimport { notAllowedPropsRecord } from '../components/Record'\r\nimport { curried, insertIf } from '../components/helpers'\r\n\r\nexport const getIdsFromRelatedCollection = (relatedToCollection, ownType) => {\r\n  return relatedToCollection.reduce((ids, record) => {\r\n    const idsToAdd = record.relationships && record.relationships[ownType] &&\r\n      record.relationships[ownType].data.map(item => item.id)\r\n\r\n    if (idsToAdd) return ids.concat(idsToAdd)\r\n    return ids\r\n  }, [])\r\n}\r\n\r\nexport const findRelatedRecords = (collection, relatedIds) => collection.filter(record => relatedIds.includes(record.id))\r\n\r\nconst relatedToSelector = mergedProps => mergedProps.ownProps.relatedTo\r\nconst collection = mergedProps => mergedProps.record[mergedProps.pluralizedType]\r\n\r\nexport const getRelatedRecords = createSelector(\r\n  relatedToSelector,\r\n  collection,\r\n  (relatedCollection, collection) => {\r\n    const relatedIds = getIdsFromRelatedCollection(relatedCollection)\r\n\r\n    return findRelatedRecords(collection, relatedIds)\r\n  }\r\n)\r\n\r\nexport const memoizedCollectionAndHelpers = createSelector(\r\n  ({ props }) => props,\r\n  ({ state }) => state.loading,\r\n  ({ state }) => state.error,\r\n  ({ collection }) => collection,\r\n  ({ buildSaveTransforms }) => buildSaveTransforms,\r\n  ({ buildRemoveTransforms }) => buildRemoveTransforms,\r\n  ({ pluralizedType }) => pluralizedType,\r\n  (props, loading, error, collection, buildSaveTransforms, buildRemoveTransforms, pluralizedType) => {\r\n    const receivedEntities = omit(props, [...notAllowedPropsCollection, props.type])\r\n    const isLoading = !!props.loading || loading\r\n    const hasError = props.error || error\r\n    const cacheOnly = props.cache !== 'skip'\r\n    const queryStatus = isLoading || hasError ? null : collection\r\n\r\n    return {\r\n      ...receivedEntities,\r\n      [pluralizedType]: cacheOnly ? collection : queryStatus,\r\n      save: (collection) => props.updateStore(buildSaveTransforms(collection)),\r\n      remove: (collection) => props.updateStore(buildRemoveTransforms(collection)),\r\n      ...insertIf(!cacheOnly, { loading: isLoading }),\r\n      ...insertIf(!cacheOnly, { error: hasError })\r\n    }\r\n  }\r\n)\r\n\r\nexport const memoizedGetExtendedRecord = createSelector(\r\n  ({ state }) => state.record,\r\n  ({ props }) => props.addRecord,\r\n  ({ props }) => props.updateRecord,\r\n  ({ props }) => props.removeRecord,\r\n  ({ setAttribute }) => setAttribute,\r\n  ({ setRelationship }) => setRelationship,\r\n  ({ addRelationship }) => addRelationship,\r\n  ({ removeRelationship }) => removeRelationship,\r\n  ({ resetAttributes }) => resetAttributes,\r\n  ({ setProperty }) => setProperty,\r\n  ({ getRelatedIds }) => getRelatedIds,\r\n  ({ getRelatedId }) => getRelatedId,\r\n  (\r\n    record,\r\n    addRecord,\r\n    updateRecord,\r\n    removeRecord,\r\n    setAttribute,\r\n    setRelationship,\r\n    addRelationship,\r\n    removeRelationship,\r\n    resetAttributes,\r\n    setProperty,\r\n    getRelatedIds,\r\n    getRelatedId\r\n  ) => {\r\n    if (!record) return null\r\n\r\n    return {\r\n      ...record,\r\n      setAttribute: curried(setAttribute),\r\n      setRelationship: curried(setRelationship),\r\n      addRelationship,\r\n      removeRelationship,\r\n      resetAttributes,\r\n      setProperty,\r\n      getRelatedIds,\r\n      getRelatedId,\r\n      save: record && !record.id\r\n        ? (options) => addRecord({ ...record }, options)\r\n        : (options) => updateRecord({ ...record }, options),\r\n      remove: (options) => removeRecord({ ...record }, options)\r\n    }\r\n  }\r\n)\r\n\r\nexport const memoizedGetRecordAndHelpers = createSelector(\r\n  ({ props }) => props,\r\n  ({ state }) => state.loading,\r\n  ({ state }) => state.error,\r\n  ({ record }) => record,\r\n  (props, loading, error, record) => {\r\n    const receivedEntities = omit(props, [...notAllowedPropsRecord, 'record', 'loading', 'error', 'initialRecord'])\r\n\r\n    return props.initialRecord\r\n      ? {\r\n        [props.type]: record,\r\n        ...receivedEntities\r\n      }\r\n      : {\r\n        [props.type]: record,\r\n        ...receivedEntities,\r\n        loading,\r\n        error\r\n      }\r\n  }\r\n)"]}]}