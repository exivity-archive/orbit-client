{"version":3,"file":"static/iframe.b5542f5114dd9dd6e60e.bundle.js","sources":["webpack:///./src/components/Crud.js"],"sourcesContent":["import { PureComponent } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n\r\nclass Crud extends PureComponent {\r\n  build = (type) => {\r\n    const { buildRecord } = this.props\r\n    return buildRecord(type)\r\n  }\r\n\r\n  isRecord = (record) => record.hasOwnProperty('type')\r\n\r\n  add = async (record, options) => {\r\n    const { beforeAdd, addRecord, onAdd, onError, extensions } = this.props\r\n\r\n    if (beforeAdd) {\r\n      const proceed = await beforeAdd(record, extensions)\r\n      const newRecord = this.isRecord(proceed) ? proceed : record\r\n\r\n      if (proceed) addRecord(newRecord, options)\r\n        .then((record) => onAdd(record, extensions))\r\n        .catch((error) => onError(error, extensions))\r\n    } else {\r\n      addRecord(record, options)\r\n        .then((record) => onAdd(record, extensions))\r\n        .catch((error) => onError(error, extensions))\r\n    }\r\n  }\r\n\r\n  update = async (record, options) => {\r\n    const { beforeUpdate, updateRecord, onUpdate, onError, extensions } = this.props\r\n\r\n    if (beforeUpdate) {\r\n      const proceed = await beforeUpdate(record, extensions)\r\n      const newRecord = this.isRecord(proceed) ? proceed : record\r\n\r\n      if (proceed) updateRecord(newRecord, options)\r\n        .then((record) => onUpdate(record, extensions))\r\n        .catch((error) => onError(error, extensions))\r\n    } else {\r\n      updateRecord(record, options)\r\n        .then((record) => onUpdate(record, extensions))\r\n        .catch((error) => onError(error, extensions))\r\n    }\r\n  }\r\n\r\n  remove = async (record, options) => {\r\n    const { beforeRemove, removeRecord, onRemove, onError, extensions } = this.props\r\n\r\n    if (beforeRemove) {\r\n      const proceed = await beforeRemove(record, extensions)\r\n      const newRecord = this.isRecord(proceed) ? proceed : record\r\n\r\n      if (proceed) removeRecord(newRecord, options)\r\n        .then((record) => onRemove(record, extensions))\r\n        .catch((error) => onError(error, extensions))\r\n    } else {\r\n      removeRecord(record, options)\r\n        .then((record) => onRemove(record, extensions))\r\n        .catch((error) => onError(error, extensions))\r\n    }\r\n  }\r\n\r\n  state = {\r\n    buildRecord: this.build,\r\n    addRecord: this.add,\r\n    updateRecord: this.update,\r\n    removeRecord: this.remove\r\n  }\r\n\r\n  render () {\r\n    return this.props.children(this.state)\r\n  }\r\n}\r\n\r\nCrud.propTypes = {\r\n  /**  Callback with build, add, update, remove promises. */\r\n  children: PropTypes.func.isRequired,\r\n  /** Function to build objectType. */\r\n  buildRecord: PropTypes.func,\r\n  /** Function to add record. */\r\n  addRecord: PropTypes.func,\r\n  /** Function to update record. */\r\n  updateRecord: PropTypes.func,\r\n  /** Function to remove record. */\r\n  removeRecord: PropTypes.func,\r\n  /** Callback called when add() resolves. Provides added record. */\r\n  onAdd: PropTypes.func,\r\n  /** Callback called when update() resolves. Provides updated record. */\r\n  onUpdate: PropTypes.func,\r\n  /** Callback called when remove() resolves. Provides removed record. */\r\n  onRemove: PropTypes.func,\r\n  /** Callback called before add(). Takes a promise or function.\r\n   Return truthy value to proceed with add() */\r\n  beforeAdd: PropTypes.func,\r\n  /** Callback called before update(). Takes a promise or function.\r\n   Return truthy value to proceed with update() */\r\n  beforeUpdate: PropTypes.func,\r\n  /** Callback called before remove(). Takes a promise or function.\r\n   Return truthy value to proceed with remove() */\r\n  beforeRemove: PropTypes.func,\r\n  /** Callback called when one of crud function catches */\r\n  onError: PropTypes.func,\r\n  /** Extensions which are provided with all callbacks */\r\n  extensions: PropTypes.object,\r\n}\r\n\r\nCrud.defaultProps = {\r\n  buildRecord: () => {},\r\n  addRecord: () => {},\r\n  updateRecord: () => {},\r\n  removeRecord: () => {},\r\n  onAdd: () => {},\r\n  onUpdate: () => {},\r\n  onRemove: () => {},\r\n  onError: () => {},\r\n  extensions: {}\r\n}\r\n\r\nexport default Crud\r\n"],"mappings":"AAIA","sourceRoot":""}